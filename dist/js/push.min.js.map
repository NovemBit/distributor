{"version":3,"sources":["webpack:///push.min.js","webpack:///webpack/bootstrap c9e15e1d5601721518a0","webpack:///external \"jQuery\"","webpack:///external \"window\"","webpack:///external \"_\"","webpack:///./assets/js/push.js"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","i","l","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","jQuery","window","_","_interopRequireDefault","obj","default","_jquery","_jquery2","_underscores","_underscores2","_window","selectedConnections","searchString","processTemplate","memoize","id","element","document","getElementById","options","evaluate","interpolate","escape","template","innerHTML","on","setVariables","connectionsSelected","distributorPushWrapper","querySelector","connectionsSelectedList","connectionsNewList","connectionsSearchInput","actionWrapper","postStatusInput","asDraftInput","debounce","event","currentTarget","value","showConnections","replace","doError","classList","add","setTimeout","remove","doSuccess","results","error","each","internal","result","connectionId","status","dtConnections","syndicated","url","external","pending","innerText","connection","nameMatch","toLowerCase","match","urlMatch","showConnection","distributorMenuEntered","distributorMenuItem","focus","body","toggle","contains","data","action","loadConnectionsNonce","dt","postId","xhr","usexhr","withCredentials","ajax","ajaxurl","xhrFields","method","done","response","success","connections","distributorMenuExited","blur","appendChild","hoverIntent","nonce","postStatus","checked","target","nodeName","preventDefault","type","getAttribute","deleteNode","parentNode","removeChild","keys","length","cloneNode","removeLink","createElement"],"mappings":"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","file":"push.min.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 6);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports) {\n\nmodule.exports = jQuery;\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports) {\n\nmodule.exports = window;\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports) {\n\nmodule.exports = _;\n\n/***/ }),\n/* 3 */,\n/* 4 */,\n/* 5 */,\n/* 6 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar _jquery = __webpack_require__(0);\n\nvar _jquery2 = _interopRequireDefault(_jquery);\n\nvar _underscores = __webpack_require__(2);\n\nvar _underscores2 = _interopRequireDefault(_underscores);\n\nvar _window = __webpack_require__(1);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar selectedConnections = {},\n    searchString = '';\n\nvar processTemplate = _underscores2.default.memoize(function (id) {\n\tvar element = document.getElementById(id);\n\tif (!element) {\n\t\treturn false;\n\t}\n\n\t// Use WordPress style Backbone template syntax\n\tvar options = {\n\t\tevaluate: /<#([\\s\\S]+?)#>/g,\n\t\tinterpolate: /{{{([\\s\\S]+?)}}}/g,\n\t\tescape: /{{([^}]+?)}}(?!})/g\n\t};\n\n\treturn _underscores2.default.template(element.innerHTML, null, options);\n});\n\n(0, _jquery2.default)(window).on('load', function () {\n\tvar distributorMenuItem = document.querySelector('#wp-admin-bar-distributor');\n\tvar distributorPushWrapper = document.querySelector('#distributor-push-wrapper');\n\n\tif (!distributorMenuItem || !distributorPushWrapper) {\n\t\treturn;\n\t}\n\n\tvar dtConnections = '';\n\tvar connectionsSelected = '';\n\tvar connectionsSelectedList = '';\n\tvar connectionsNewList = '';\n\tvar connectionsSearchInput = '';\n\tvar actionWrapper = '';\n\tvar postStatusInput = '';\n\tvar asDraftInput = '';\n\n\tdistributorMenuItem.appendChild(distributorPushWrapper);\n\n\t/**\r\n  * Set variables after connections have been rendered\r\n  */\n\tfunction setVariables() {\n\t\tconnectionsSelected = distributorPushWrapper.querySelector('.connections-selected');\n\t\tconnectionsSelectedList = distributorPushWrapper.querySelector('.selected-connections-list');\n\t\tconnectionsNewList = distributorPushWrapper.querySelector('.new-connections-list');\n\t\tconnectionsSearchInput = document.getElementById('dt-connection-search');\n\t\tactionWrapper = distributorPushWrapper.querySelector('.action-wrapper');\n\t\tpostStatusInput = document.getElementById('dt-post-status');\n\t\tasDraftInput = document.getElementById('dt-as-draft');\n\n\t\t/**\r\n   * Listen for connection filtering\r\n   */\n\t\t(0, _jquery2.default)(connectionsSearchInput).on('keyup change', _underscores2.default.debounce(function (event) {\n\t\t\tif ('' === event.currentTarget.value) {\n\t\t\t\tshowConnections(dtConnections);\n\t\t\t}\n\n\t\t\tsearchString = event.currentTarget.value.replace(/https?:\\/\\//i, '').replace(/www/i, '').replace(/[^0-9a-zA-Z ]+/, '');\n\n\t\t\tshowConnections();\n\t\t}, 300));\n\t}\n\n\t/**\r\n  * Handle UI error changes\r\n  */\n\tfunction doError() {\n\t\tdistributorPushWrapper.classList.add('message-error');\n\n\t\tsetTimeout(function () {\n\t\t\tdistributorPushWrapper.classList.remove('message-error');\n\t\t}, 6000);\n\t}\n\n\t/**\r\n  * Handle UI success changes\r\n  */\n\tfunction doSuccess(results) {\n\t\tvar error = false;\n\n\t\t_underscores2.default.each(results.internal, function (result, connectionId) {\n\t\t\tif ('fail' === result.status) {\n\t\t\t\terror = true;\n\t\t\t} else {\n\t\t\t\tdtConnections['internal' + connectionId].syndicated = result.url;\n\t\t\t}\n\t\t});\n\n\t\t_underscores2.default.each(results.external, function (result, connectionId) {\n\t\t\tif ('fail' === result.status) {\n\t\t\t\terror = true;\n\t\t\t} else {\n\t\t\t\tdtConnections['external' + connectionId].syndicated = true;\n\t\t\t\tdtConnections['external' + connectionId].pending = true;\n\t\t\t}\n\t\t});\n\n\t\tif (error) {\n\t\t\tdoError();\n\t\t} else {\n\t\t\tdistributorPushWrapper.classList.add('message-success');\n\n\t\t\tconnectionsSelected.classList.add('empty');\n\t\t\tconnectionsSelectedList.innerText = '';\n\n\t\t\tsetTimeout(function () {\n\t\t\t\tdistributorPushWrapper.classList.remove('message-success');\n\t\t\t}, 6000);\n\t\t}\n\n\t\tselectedConnections = {};\n\n\t\tshowConnections();\n\t}\n\n\t/**\r\n \t * Show connections. If there is a search string, then filter by it\r\n \t */\n\tfunction showConnections() {\n\t\tconnectionsNewList.innerText = '';\n\n\t\t_underscores2.default.each(dtConnections, function (connection) {\n\t\t\tif ('' !== searchString) {\n\t\t\t\tvar nameMatch = connection.name.replace(/[^0-9a-zA-Z ]+/, '').toLowerCase().match(searchString.toLowerCase());\n\t\t\t\tvar urlMatch = connection.url.replace(/https?:\\/\\//i, '').replace(/www/i, '').replace(/[^0-9a-zA-Z ]+/, '').toLowerCase().match(searchString.toLowerCase());\n\n\t\t\t\tif (!nameMatch && !urlMatch) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar showConnection = processTemplate('dt-add-connection')({\n\t\t\t\tconnection: connection,\n\t\t\t\tselectedConnections: selectedConnections\n\t\t\t});\n\n\t\t\tconnectionsNewList.innerHTML += showConnection;\n\t\t});\n\t}\n\n\t/**\r\n  * Handle distributor push dropdown menu hover using hoverIntent.\r\n  */\n\tfunction distributorMenuEntered() {\n\t\tdistributorMenuItem.focus();\n\t\tdocument.body.classList.toggle('distributor-show');\n\n\t\tif (distributorPushWrapper.classList.contains('loaded')) {\n\t\t\treturn;\n\t\t}\n\n\t\tdistributorPushWrapper.classList.remove('message-error');\n\t\tdistributorPushWrapper.classList.add('loaded');\n\n\t\tvar data = {\n\t\t\taction: 'dt_load_connections',\n\t\t\tloadConnectionsNonce: _window.dt.loadConnectionsNonce,\n\t\t\tpostId: _window.dt.postId\n\t\t};\n\n\t\tvar xhr = _window.dt.usexhr ? { withCredentials: true } : false;\n\n\t\t_jquery2.default.ajax({\n\t\t\turl: _window.dt.ajaxurl,\n\t\t\txhrFields: xhr,\n\t\t\tmethod: 'post',\n\t\t\tdata: data\n\t\t}).done(function (response) {\n\t\t\tif (!response.success || !response.data) {\n\t\t\t\tdistributorPushWrapper.classList.remove('loaded');\n\t\t\t\tdistributorPushWrapper.classList.add('message-error');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tdtConnections = response.data;\n\n\t\t\t// Allowing innerHTML because processTemplate escapes values\n\t\t\tdistributorPushWrapper.innerHTML = processTemplate('dt-show-connections')({\n\t\t\t\tconnections: dtConnections\n\t\t\t});\n\n\t\t\tsetVariables();\n\t\t}).error(function () {\n\t\t\tdistributorPushWrapper.classList.remove('loaded');\n\t\t\tdistributorPushWrapper.classList.add('message-error');\n\t\t});\n\t}\n\n\t/**\r\n  * Handle exiting the distributor menu.\r\n  */\n\tfunction distributorMenuExited() {\n\t\tdistributorMenuItem.blur();\n\t\tdocument.body.classList.toggle('distributor-show');\n\t}\n\n\t(0, _jquery2.default)(distributorMenuItem).hoverIntent(distributorMenuEntered, 300, distributorMenuExited);\n\n\t/**\r\n  * Do syndication ajax\r\n  */\n\t(0, _jquery2.default)(distributorPushWrapper).on('click', '.syndicate-button', function () {\n\t\tif (actionWrapper.classList.contains('loading')) {\n\t\t\treturn;\n\t\t}\n\n\t\tactionWrapper.classList.add('loading');\n\n\t\tvar data = {\n\t\t\taction: 'dt_push',\n\t\t\tnonce: _window.dt.nonce,\n\t\t\tconnections: selectedConnections,\n\t\t\tpostId: _window.dt.postId\n\t\t};\n\n\t\tdata.postStatus = null !== asDraftInput && asDraftInput.checked ? 'draft' : postStatusInput.value;\n\n\t\tvar xhr = _window.dt.usexhr ? { withCredentials: true } : false;\n\n\t\t_jquery2.default.ajax({\n\t\t\turl: _window.dt.ajaxurl,\n\t\t\txhrFields: xhr,\n\t\t\tmethod: 'post',\n\t\t\tdata: data\n\t\t}).done(function (response) {\n\t\t\tsetTimeout(function () {\n\t\t\t\tactionWrapper.classList.remove('loading');\n\n\t\t\t\tif (!response.data || !response.data.results) {\n\t\t\t\t\tdoError();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tdoSuccess(response.data.results);\n\t\t\t}, 500);\n\t\t}).error(function () {\n\t\t\tsetTimeout(function () {\n\t\t\t\tactionWrapper.classList.remove('loading');\n\n\t\t\t\tdoError();\n\t\t\t}, 500);\n\t\t});\n\t});\n\n\t/**\r\n  * Add a connection to selected connections for ajax and to the UI list.\r\n  */\n\t(0, _jquery2.default)(distributorPushWrapper).on('click', '.add-connection', function (event) {\n\t\tif ('A' === event.target.nodeName) {\n\t\t\treturn;\n\t\t}\n\n\t\tevent.preventDefault();\n\n\t\tif (event.currentTarget.classList.contains('syndicated')) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (event.currentTarget.classList.contains('added')) {\n\n\t\t\tvar type = event.currentTarget.getAttribute('data-connection-type');\n\t\t\tvar id = event.currentTarget.getAttribute('data-connection-id');\n\n\t\t\tvar deleteNode = connectionsSelectedList.querySelector('[data-connection-id=\"' + id + '\"][data-connection-type=\"' + type + '\"]');\n\n\t\t\tdeleteNode.parentNode.removeChild(deleteNode);\n\n\t\t\tdelete selectedConnections[type + id];\n\n\t\t\tif (!Object.keys(selectedConnections).length) {\n\t\t\t\tconnectionsSelected.classList.add('empty');\n\t\t\t}\n\n\t\t\tshowConnections();\n\t\t} else {\n\n\t\t\tvar _type = event.currentTarget.getAttribute('data-connection-type');\n\t\t\tvar _id = event.currentTarget.getAttribute('data-connection-id');\n\n\t\t\tselectedConnections[_type + _id] = dtConnections[_type + _id];\n\n\t\t\tconnectionsSelected.classList.remove('empty');\n\n\t\t\tvar element = event.currentTarget.cloneNode();\n\t\t\telement.innerText = event.currentTarget.innerText;\n\n\t\t\tvar removeLink = document.createElement('span');\n\t\t\tremoveLink.classList.add('remove-connection');\n\n\t\t\telement.appendChild(removeLink);\n\t\t\telement.classList = 'added-connection';\n\n\t\t\tconnectionsSelectedList.appendChild(element);\n\n\t\t\tshowConnections();\n\t\t}\n\t});\n\n\t/**\r\n  * Remove a connection from selected connections and the UI list\r\n  */\n\t(0, _jquery2.default)(distributorPushWrapper).on('click', '.remove-connection', function (event) {\n\t\tevent.currentTarget.parentNode.parentNode.removeChild(event.currentTarget.parentNode);\n\t\tvar type = event.currentTarget.parentNode.getAttribute('data-connection-type');\n\t\tvar id = event.currentTarget.parentNode.getAttribute('data-connection-id');\n\n\t\tdelete selectedConnections[type + id];\n\n\t\tif (!Object.keys(selectedConnections).length) {\n\t\t\tconnectionsSelected.classList.add('empty');\n\t\t}\n\n\t\tshowConnections();\n\t});\n});\n\n/***/ })\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// push.min.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 6);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap c9e15e1d5601721518a0","module.exports = jQuery;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"jQuery\"\n// module id = 0\n// module chunks = 0 1 4 5","module.exports = window;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"window\"\n// module id = 1\n// module chunks = 0 1 2 3","module.exports = _;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"_\"\n// module id = 2\n// module chunks = 0 1","import jQuery from 'jquery';\r\nimport _ from 'underscores';\r\nimport { dt } from 'window';\r\n\r\nlet selectedConnections = {},\r\n\tsearchString        = '';\r\n\r\nconst processTemplate = _.memoize( ( id ) => {\r\n\tconst element = document.getElementById( id );\r\n\tif ( ! element ) {\r\n\t\treturn false;\r\n\t}\r\n\r\n\t// Use WordPress style Backbone template syntax\r\n\tconst options = {\r\n\t\tevaluate:    /<#([\\s\\S]+?)#>/g,\r\n\t\tinterpolate: /{{{([\\s\\S]+?)}}}/g,\r\n\t\tescape:      /{{([^}]+?)}}(?!})/g\r\n\t};\r\n\r\n\treturn _.template( element.innerHTML, null, options );\r\n} );\r\n\r\njQuery( window ).on( 'load', () => {\r\n\tconst distributorMenuItem     = document.querySelector( '#wp-admin-bar-distributor' );\r\n\tconst distributorPushWrapper  = document.querySelector( '#distributor-push-wrapper' );\r\n\r\n\tif ( ! distributorMenuItem || ! distributorPushWrapper ) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tlet dtConnections           = '';\r\n\tlet connectionsSelected     = '';\r\n\tlet connectionsSelectedList = '';\r\n\tlet connectionsNewList      = '';\r\n\tlet connectionsSearchInput  = '';\r\n\tlet actionWrapper           = '';\r\n\tlet postStatusInput         = '';\r\n\tlet asDraftInput            = '';\r\n\r\n\tdistributorMenuItem.appendChild( distributorPushWrapper );\r\n\r\n\t/**\r\n\t * Set variables after connections have been rendered\r\n\t */\r\n\tfunction setVariables() {\r\n\t\tconnectionsSelected     = distributorPushWrapper.querySelector( '.connections-selected' );\r\n\t\tconnectionsSelectedList = distributorPushWrapper.querySelector( '.selected-connections-list' );\r\n\t\tconnectionsNewList      = distributorPushWrapper.querySelector( '.new-connections-list' );\r\n\t\tconnectionsSearchInput  = document.getElementById( 'dt-connection-search' );\r\n\t\tactionWrapper           = distributorPushWrapper.querySelector( '.action-wrapper' );\r\n\t\tpostStatusInput         = document.getElementById( 'dt-post-status' );\r\n\t\tasDraftInput            = document.getElementById( 'dt-as-draft' );\r\n\r\n\t\t/**\r\n\t\t * Listen for connection filtering\r\n\t\t */\r\n\t\tjQuery( connectionsSearchInput ).on( 'keyup change', _.debounce( ( event ) => {\r\n\t\t\tif ( '' === event.currentTarget.value ) {\r\n\t\t\t\tshowConnections( dtConnections );\r\n\t\t\t}\r\n\r\n\t\t\tsearchString = event.currentTarget.value.replace( /https?:\\/\\//i, '' ).replace( /www/i, '' ).replace( /[^0-9a-zA-Z ]+/, '' );\r\n\r\n\t\t\tshowConnections();\r\n\t\t}, 300 ) );\r\n\t}\r\n\r\n\t/**\r\n\t * Handle UI error changes\r\n\t */\r\n\tfunction doError() {\r\n\t\tdistributorPushWrapper.classList.add( 'message-error' );\r\n\r\n\t\tsetTimeout( () => {\r\n\t\t\tdistributorPushWrapper.classList.remove( 'message-error' );\r\n\t\t}, 6000 );\r\n\t}\r\n\r\n\t/**\r\n\t * Handle UI success changes\r\n\t */\r\n\tfunction doSuccess( results ) {\r\n\t\tlet error = false;\r\n\r\n\t\t_.each( results.internal, ( result, connectionId ) => {\r\n\t\t\tif ( 'fail' === result.status ) {\r\n\t\t\t\terror = true;\r\n\t\t\t} else {\r\n\t\t\t\tdtConnections['internal' + connectionId].syndicated = result.url;\r\n\t\t\t}\r\n\t\t} );\r\n\r\n\t\t_.each( results.external, ( result, connectionId ) => {\r\n\t\t\tif ( 'fail' === result.status ) {\r\n\t\t\t\terror = true;\r\n\t\t\t} else {\r\n\t\t\t\tdtConnections['external' + connectionId].syndicated = true;\r\n\t\t\t\tdtConnections['external' + connectionId].pending = true;\r\n\t\t\t}\r\n\t\t} );\r\n\r\n\t\tif ( error ) {\r\n\t\t\tdoError();\r\n\t\t} else {\r\n\t\t\tdistributorPushWrapper.classList.add( 'message-success' );\r\n\r\n\t\t\tconnectionsSelected.classList.add( 'empty' );\r\n\t\t\tconnectionsSelectedList.innerText = '';\r\n\r\n\t\t\tsetTimeout( () => {\r\n\t\t\t\tdistributorPushWrapper.classList.remove( 'message-success' );\r\n\t\t\t}, 6000 );\r\n\t\t}\r\n\r\n\t\tselectedConnections = {};\r\n\r\n\t\tshowConnections();\r\n\t}\r\n\r\n\t/**\r\n\t\t * Show connections. If there is a search string, then filter by it\r\n\t\t */\r\n\tfunction showConnections() {\r\n\t\tconnectionsNewList.innerText = '';\r\n\r\n\t\t_.each( dtConnections, ( connection ) => {\r\n\t\t\tif ( '' !== searchString ) {\r\n\t\t\t\tlet nameMatch = connection.name.replace( /[^0-9a-zA-Z ]+/, '' ).toLowerCase().match( searchString.toLowerCase() );\r\n\t\t\t\tlet urlMatch  = connection.url.replace( /https?:\\/\\//i, '' ).replace( /www/i, '' ).replace( /[^0-9a-zA-Z ]+/, '' ).toLowerCase().match( searchString.toLowerCase() );\r\n\r\n\t\t\t\tif ( ! nameMatch && ! urlMatch ) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tconst showConnection = processTemplate( 'dt-add-connection' )( {\r\n\t\t\t\tconnection: connection,\r\n\t\t\t\tselectedConnections: selectedConnections\r\n\t\t\t} );\r\n\r\n\t\t\tconnectionsNewList.innerHTML += showConnection;\r\n\t\t} );\r\n\t}\r\n\r\n\t/**\r\n\t * Handle distributor push dropdown menu hover using hoverIntent.\r\n\t */\r\n\tfunction distributorMenuEntered() {\r\n\t\tdistributorMenuItem.focus();\r\n\t\tdocument.body.classList.toggle( 'distributor-show' );\r\n\r\n\t\tif ( distributorPushWrapper.classList.contains( 'loaded' ) ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tdistributorPushWrapper.classList.remove( 'message-error' );\r\n\t\tdistributorPushWrapper.classList.add( 'loaded' );\r\n\r\n\t\tconst data = {\r\n\t\t\taction: 'dt_load_connections',\r\n\t\t\tloadConnectionsNonce: dt.loadConnectionsNonce,\r\n\t\t\tpostId: dt.postId\r\n\t\t};\r\n\r\n\t\tconst xhr = dt.usexhr ? { withCredentials: true } : false;\r\n\r\n\t\tjQuery.ajax( {\r\n\t\t\turl: dt.ajaxurl,\r\n\t\t\txhrFields: xhr,\r\n\t\t\tmethod: 'post',\r\n\t\t\tdata: data\r\n\t\t} ).done( ( response ) => {\r\n\t\t\tif ( ! response.success || ! response.data ) {\r\n\t\t\t\tdistributorPushWrapper.classList.remove( 'loaded' );\r\n\t\t\t\tdistributorPushWrapper.classList.add( 'message-error' );\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tdtConnections = response.data;\r\n\r\n\t\t\t// Allowing innerHTML because processTemplate escapes values\r\n\t\t\tdistributorPushWrapper.innerHTML = processTemplate( 'dt-show-connections' )( {\r\n\t\t\t\tconnections: dtConnections,\r\n\t\t\t} );\r\n\r\n\t\t\tsetVariables();\r\n\t\t} ).error( () => {\r\n\t\t\tdistributorPushWrapper.classList.remove( 'loaded' );\r\n\t\t\tdistributorPushWrapper.classList.add( 'message-error' );\r\n\t\t} );\r\n\t}\r\n\r\n\t/**\r\n\t * Handle exiting the distributor menu.\r\n\t */\r\n\tfunction distributorMenuExited() {\r\n\t\tdistributorMenuItem.blur();\r\n\t\tdocument.body.classList.toggle( 'distributor-show' );\r\n\t}\r\n\r\n\tjQuery( distributorMenuItem ).hoverIntent( distributorMenuEntered, 300, distributorMenuExited );\r\n\r\n\t/**\r\n\t * Do syndication ajax\r\n\t */\r\n\tjQuery( distributorPushWrapper ).on( 'click', '.syndicate-button', () => {\r\n\t\tif ( actionWrapper.classList.contains( 'loading' ) ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tactionWrapper.classList.add( 'loading' );\r\n\r\n\t\tconst data = {\r\n\t\t\taction: 'dt_push',\r\n\t\t\tnonce: dt.nonce,\r\n\t\t\tconnections: selectedConnections,\r\n\t\t\tpostId: dt.postId\r\n\t\t};\r\n\r\n\t\tdata.postStatus = ( null !== asDraftInput && asDraftInput.checked ) ? 'draft' : postStatusInput.value;\r\n\r\n\t\tconst xhr = dt.usexhr ? { withCredentials: true } : false;\r\n\r\n\t\tjQuery.ajax( {\r\n\t\t\turl: dt.ajaxurl,\r\n\t\t\txhrFields: xhr,\r\n\t\t\tmethod: 'post',\r\n\t\t\tdata: data\r\n\t\t} ).done( ( response ) => {\r\n\t\t\tsetTimeout( () => {\r\n\t\t\t\tactionWrapper.classList.remove( 'loading' );\r\n\r\n\t\t\t\tif ( ! response.data || ! response.data.results ) {\r\n\t\t\t\t\tdoError();\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tdoSuccess( response.data.results );\r\n\t\t\t}, 500 );\r\n\t\t} ).error( () => {\r\n\t\t\tsetTimeout( () => {\r\n\t\t\t\tactionWrapper.classList.remove( 'loading' );\r\n\r\n\t\t\t\tdoError();\r\n\t\t\t}, 500 );\r\n\t\t} );\r\n\t} );\r\n\r\n\t/**\r\n\t * Add a connection to selected connections for ajax and to the UI list.\r\n\t */\r\n\tjQuery( distributorPushWrapper ).on( 'click', '.add-connection', ( event ) => {\r\n\t\tif ( 'A' === event.target.nodeName ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tevent.preventDefault();\r\n\r\n\t\tif ( event.currentTarget.classList.contains( 'syndicated' ) ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif ( event.currentTarget.classList.contains( 'added' ) ) {\r\n\r\n\t\t\tconst type = event.currentTarget.getAttribute( 'data-connection-type' );\r\n\t\t\tconst id   = event.currentTarget.getAttribute( 'data-connection-id' );\r\n\r\n\t\t\tconst deleteNode = connectionsSelectedList.querySelector( '[data-connection-id=\"' + id + '\"][data-connection-type=\"' + type + '\"]' );\r\n\r\n\t\t\tdeleteNode.parentNode.removeChild( deleteNode );\r\n\r\n\t\t\tdelete selectedConnections[type + id];\r\n\r\n\t\t\tif ( ! Object.keys( selectedConnections ).length ) {\r\n\t\t\t\tconnectionsSelected.classList.add( 'empty' );\r\n\t\t\t}\r\n\r\n\t\t\tshowConnections();\r\n\t\t} else {\r\n\r\n\t\t\tconst type = event.currentTarget.getAttribute( 'data-connection-type' );\r\n\t\t\tconst id   = event.currentTarget.getAttribute( 'data-connection-id' );\r\n\r\n\t\t\tselectedConnections[type + id] = dtConnections[type + id];\r\n\r\n\t\t\tconnectionsSelected.classList.remove( 'empty' );\r\n\r\n\t\t\tconst element       = event.currentTarget.cloneNode();\r\n\t\t\telement.innerText = event.currentTarget.innerText;\r\n\r\n\t\t\tconst removeLink = document.createElement( 'span' );\r\n\t\t\tremoveLink.classList.add( 'remove-connection' );\r\n\r\n\t\t\telement.appendChild( removeLink );\r\n\t\t\telement.classList = 'added-connection';\r\n\r\n\t\t\tconnectionsSelectedList.appendChild( element );\r\n\r\n\t\t\tshowConnections();\r\n\t\t}\r\n\t} );\r\n\r\n\t/**\r\n\t * Remove a connection from selected connections and the UI list\r\n\t */\r\n\tjQuery( distributorPushWrapper ).on( 'click', '.remove-connection', ( event ) => {\r\n\t\tevent.currentTarget.parentNode.parentNode.removeChild( event.currentTarget.parentNode );\r\n\t\tconst type = event.currentTarget.parentNode.getAttribute( 'data-connection-type' );\r\n\t\tconst id   = event.currentTarget.parentNode.getAttribute( 'data-connection-id' );\r\n\r\n\t\tdelete selectedConnections[type + id];\r\n\r\n\t\tif ( ! Object.keys( selectedConnections ).length ) {\r\n\t\t\tconnectionsSelected.classList.add( 'empty' );\r\n\t\t}\r\n\r\n\t\tshowConnections();\r\n\t} );\r\n} );\r\n\n\n\n// WEBPACK FOOTER //\n// ./assets/js/push.js"],"sourceRoot":""}